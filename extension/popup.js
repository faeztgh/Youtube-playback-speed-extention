import{j as t,c as p,r as d,g as T,s as g,A as w,U as W,D as f,S as D,P as H,I as O,a as z,b as V,o as G,H as J,d as K,e as Y,f as $,h as Q}from"./chunks/PresetList-OIWQbCsp.js";import{f as j}from"./chunks/badge-CCCdnOXL.js";const X=({mode:e})=>e==="light"?t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("path",{d:"M12 4V2M12 22v-2M4 12H2M22 12h-2M5.64 5.64 4.22 4.22M19.78 19.78l-1.42-1.42M18.36 5.64l1.42-1.42M4.22 19.78l1.42-1.42",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),t.jsx("circle",{cx:"12",cy:"12",r:"4.5",stroke:"currentColor",strokeWidth:"1.5"})]}):e==="dark"?t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:"currentColor",strokeWidth:"1.5",fill:"currentColor"})}):t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),t.jsx("path",{d:"M3 15h18",stroke:"currentColor",strokeWidth:"1.5"})]}),Z=({value:e,onChange:a,className:l})=>{const s=["system","light","dark"];return t.jsx("div",{className:(l??"")+" flex items-center gap-1 rounded-lg border border-white/20 bg-white/10 p-0.5",role:"group","aria-label":"Theme",children:s.map(n=>{const o=e===n;return t.jsx("button",{type:"button","aria-pressed":o,onClick:()=>a(n),className:"w-8 h-8 grid place-items-center rounded-md text-white/85 transition "+(o?"bg-white !text-[#0f0f0f] shadow ring-1 ring-white/50":"hover:bg-white/10 active:bg-white/20"),title:n[0].toUpperCase()+n.slice(1),"aria-label":n,children:t.jsx(X,{mode:n})},n)})})},ee=({tabs:e,value:a,onChange:l,className:s})=>t.jsx("div",{className:(s??"")+" flex gap-1 bg-neutral-100 dark:bg-neutral-900 p-1 rounded-lg border border-neutral-200 dark:border-neutral-800",children:e.map(n=>{const o=n.key===a;return t.jsx("button",{onClick:()=>l(n.key),className:"px-3 py-1.5 rounded-md text-sm transition "+(o?"bg-white dark:bg-neutral-800 shadow border border-neutral-200 dark:border-neutral-700":"hover:bg-white/60 dark:hover:bg-neutral-800/60"),"aria-selected":o,role:"tab",children:t.jsxs("span",{className:"flex items-center gap-2",children:[n.icon,t.jsx("span",{children:n.label})]})},n.key)})});/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=p("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=p("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=p("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=p("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=p("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=p("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=p("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ie=()=>{const[e,a]=d.useState(null),l=d.useRef(null);if(d.useEffect(()=>{T().then(a)},[]),!e)return null;const s=async()=>{const i=JSON.stringify(e,null,2),c=new Blob([i],{type:"application/json"}),x=URL.createObjectURL(c),y=document.createElement("a");y.href=x,y.download="media-controller-settings.json",y.click(),URL.revokeObjectURL(x)},n=async i=>{const c=await i.text(),x=JSON.parse(c);await g(x),a(x)},o=async()=>{await g(f),a(f)};return t.jsxs("div",{className:"mt-3 space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.rememberLastPerChannel,onChange:async i=>{const c={rememberLastPerChannel:i.target.checked};await g(c),a({...e,...c})}}),t.jsx("span",{children:"Remember last used speed per channel"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.visible||e.showOverlay,onChange:async i=>{const c={overlay:{...e.overlay,visible:i.target.checked},showOverlay:i.target.checked};await g(c),a({...e,...c})}}),t.jsx("span",{children:"Show in-player controller overlay"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.autoHide,onChange:async i=>{const c={overlay:{...e.overlay,autoHide:i.target.checked}};await g(c),a({...e,...c})}}),t.jsx("span",{children:"Auto-hide overlay until hovered"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(w,{onClick:s,children:[t.jsx(se,{className:"w-4 h-4"}),t.jsx("span",{children:"Export settings"})]}),t.jsx("input",{ref:l,type:"file",accept:"application/json",className:"hidden",onChange:i=>i.target.files&&n(i.target.files[0])}),t.jsxs(w,{onClick:()=>l.current?.click(),children:[t.jsx(W,{className:"w-4 h-4"}),t.jsx("span",{children:"Import settings"})]}),t.jsxs(w,{variant:"danger",className:"ml-auto",onClick:o,children:[t.jsx(ne,{className:"w-4 h-4"}),t.jsx("span",{children:"Reset to defaults"})]})]})]})};function oe({children:e,className:a=""}){return t.jsx("div",{className:`p-5 rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 shadow-sm ${a}`,children:e})}const de=e=>{const a=e.rates.length?Math.min(.1,...e.rates):.1,l=e.rates.length?Math.max(4,...e.rates):4;return t.jsxs("div",{className:"mt-3",children:[t.jsx(oe,{className:"hover:shadow-md",children:t.jsx(D,{min:a,max:l,value:e.sliderRate,onChange:async s=>{e.setSliderRate(s),await e.apply(s)},onClear:async()=>{e.setSliderRate(e.defaultRate),await e.apply(e.defaultRate)}})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(H,{presets:e.rates,onSelect:async s=>{e.setSliderRate(s),await e.apply(s)},onRemove:e.removeRate,currentRate:e.sliderRate}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx(O,{type:"number",uiSize:"md",step:"0.05",placeholder:"Custom speed (e.g. 1.25)",value:e.customRateInput,onChange:s=>e.setCustomRateInput(s.target.value),onKeyDown:s=>{s.key==="Enter"&&e.addCustomRate()},className:"flex-1 placeholder:text-neutral-400",inputMode:"decimal","aria-label":"Custom speed"}),t.jsxs(w,{onClick:e.addCustomRate,children:[t.jsx(z,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Add"})]}),t.jsxs(w,{onClick:e.addRate,children:[t.jsx(te,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"+0.25"})]})]})]}),t.jsx("div",{className:"flex items-center gap-2 mt-4",children:t.jsx("div",{className:"ml-auto",children:t.jsxs(w,{onClick:e.onSave,children:[t.jsx(V,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Save"})]})})})]})};function he(e){return Math.max(.1,e)}function ue(){const e=document.querySelector("video.html5-main-video");return e&&!Number.isNaN(e.playbackRate)?e:document.querySelector("video")}function M(e){return e.__reverseController??null}function I(e,a){e.__reverseController=a}function R(e){const a=M(e);a?.rafId&&cancelAnimationFrame(a.rafId),I(e,null)}function me(e,a){R(e);const l={rafId:null,lastTimestampMs:null,speedAbs:a};I(e,l);try{e.pause()}catch{}const s=n=>{if(!document.contains(e)){R(e);return}const o=M(e);if(!o)return;const i=o.lastTimestampMs??n,c=Math.min(.25,Math.max(0,(n-i)/1e3));o.lastTimestampMs=n;const x=c*o.speedAbs,y=Math.max(0,e.currentTime-x);e.currentTime=y,o.rafId=requestAnimationFrame(s)};l.rafId=requestAnimationFrame(s)}function xe(e){const a=ue();if(!a)return!1;if(e<0){const s=Math.abs(e);return a.playbackRate=0,me(a,s),a.dispatchEvent(new Event("ratechange")),!0}R(a);const l=he(e);return a.playbackRate=l,a.dispatchEvent(new Event("ratechange")),!0}const m=globalThis.browser??chrome;async function ye(e){try{if(m?.tabs?.query){const[a]=await m.tabs.query({active:!0,currentWindow:!0});if(a?.id)try{await m.tabs.sendMessage(a.id,{type:"SET_PLAYBACK_RATE",rate:e}),await m.action.setBadgeBackgroundColor({tabId:a.id,color:"#111827"}),m.action?.setBadgeTextColor&&await m.action.setBadgeTextColor({tabId:a.id,color:"#FFFFFF"}),await m.action.setBadgeText({tabId:a.id,text:j(e)});return}catch{try{m.scripting?.executeScript&&await m.scripting.executeScript({target:{tabId:a.id},func:l=>{const s=document.querySelector("video");s&&(s.playbackRate=l,s.dispatchEvent(new Event("ratechange")))},args:[e]}),await m.action.setBadgeBackgroundColor({tabId:a.id,color:"#111827"}),m.action?.setBadgeTextColor&&await m.action.setBadgeTextColor({tabId:a.id,color:"#FFFFFF"}),await m.action.setBadgeText({tabId:a.id,text:j(e)});return}catch{}}}}catch{}xe(e)}function S(e){return Math.round(e*100)/100}const b=globalThis.browser??chrome,ge=()=>{const[e,a]=d.useState(f.customRates),[l,s]=d.useState(f.defaultPlaybackRate),[n,o]=d.useState(f.theme??"system"),[i,c]=d.useState(f.defaultPlaybackRate),[x,y]=d.useState(""),[k,A]=d.useState("general"),[C,E]=d.useState(null),N=d.useRef(null);d.useEffect(()=>{N.current=C},[C]),d.useEffect(()=>{(async()=>{const r=await T();a(r.customRates),s(r.defaultPlaybackRate),o(r.theme??"system"),c(r.defaultPlaybackRate||1);const[h]=await b.tabs.query({active:!0,currentWindow:!0});if(E(h?.id??null),h?.id)try{await b.tabs.sendMessage(h.id,{type:"GET_PLAYBACK_RATE"})}catch{}})()},[]),d.useEffect(()=>{const r=document.documentElement,h=n==="dark"||n==="system"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;r.classList.toggle("dark",h)},[n]),d.useEffect(()=>{G((r,h)=>{if(r.type==="CURRENT_PLAYBACK_RATE"){const u=h.tab?.id??null;u&&u===N.current&&(c(r.rate),s(r.rate),(async()=>{try{await b.action.setBadgeBackgroundColor({tabId:u,color:"#111827"}),b.action?.setBadgeTextColor&&await b.action.setBadgeTextColor({tabId:u,color:"#FFFFFF"}),await b.action.setBadgeText({tabId:u,text:j(r.rate)})}catch{}})())}})},[]);async function B(r){await $({type:"PAUSE_AUTOMATION",ms:1e4}),await ye(r),g({defaultPlaybackRate:r})}async function P(){await g({customRates:e,defaultPlaybackRate:l,theme:n})}const F=()=>a(r=>Array.from(new Set([...r,S((r[r.length-1]??1)+.25)])).sort((h,u)=>h-u)),L=()=>{const r=Number(x);if(!Number.isFinite(r)||r<=0)return;const h=S(r);a(u=>Array.from(new Set([...u,h])).sort((v,_)=>v-_)),y("")},q=r=>{a(h=>h.filter(u=>u!==r).sort((u,v)=>u-v))},U=[{key:"general",label:"General",icon:t.jsx(le,{className:"w-4 h-4"})},{key:"profiles",label:"Profiles",icon:t.jsx(ae,{className:"w-4 h-4"})},{key:"automation",label:"Automation",icon:t.jsx(ce,{className:"w-4 h-4"})},{key:"settings",label:"Settings",icon:t.jsx(re,{className:"w-4 h-4"})}];return t.jsxs("div",{className:"min-w-[700px] p-0 font-sans text-neutral-900 dark:text-neutral-100 bg-white dark:bg-neutral-950",children:[t.jsxs("div",{className:"px-4 py-3 mb-0 bg-[#0f0f0f] text-white flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col leading-tight",children:[t.jsx("span",{className:"text-sm opacity-80",children:"Playback Controller"}),t.jsx("h3",{className:"m-0 text-lg font-semibold tracking-wide",children:"Media Controls"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("a",{href:"https://hamibash.com/faez",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 text-white text-sm border border-white/15 transition active:scale-[.98]",children:[t.jsx(J,{className:"w-4 h-4"}),t.jsx("span",{children:"Support"})]}),t.jsx(Z,{value:n,onChange:o})]})]}),t.jsxs("div",{className:"p-4 pt-3",children:[t.jsx(ee,{tabs:U,value:k,onChange:A}),k==="general"&&t.jsx(de,{rates:e,sliderRate:i,setSliderRate:c,defaultRate:l,apply:B,onSave:P,removeRate:q,customRateInput:x,setCustomRateInput:y,addCustomRate:L,addRate:F}),k==="profiles"&&t.jsx(K,{}),k==="automation"&&t.jsx(Y,{}),k==="settings"&&t.jsx(ie,{})]})]})},pe=Q.createRoot(document.getElementById("root"));pe.render(t.jsx(ge,{}));
