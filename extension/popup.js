import{j as t,c as f,r as u,g as M,s as p,A as w,U as W,D as k,S as D,P as H,I as O,a as z,b as V,o as G,H as J,d as K,e as Y,f as Q,h as X}from"./chunks/PresetList-BZDvVy-t.js";import{f as R}from"./chunks/badge-CCCdnOXL.js";const Z=({mode:e})=>e==="light"?t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("path",{d:"M12 4V2M12 22v-2M4 12H2M22 12h-2M5.64 5.64 4.22 4.22M19.78 19.78l-1.42-1.42M18.36 5.64l1.42-1.42M4.22 19.78l1.42-1.42",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),t.jsx("circle",{cx:"12",cy:"12",r:"4.5",stroke:"currentColor",strokeWidth:"1.5"})]}):e==="dark"?t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:"currentColor",strokeWidth:"1.5",fill:"currentColor"})}):t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),t.jsx("path",{d:"M3 15h18",stroke:"currentColor",strokeWidth:"1.5"})]}),$=({value:e,onChange:a,className:o})=>{const r=["system","light","dark"];return t.jsx("div",{className:(o??"")+" flex items-center gap-1 rounded-lg border border-white/20 bg-white/10 p-0.5",role:"group","aria-label":"Theme",children:r.map(s=>{const n=e===s;return t.jsx("button",{type:"button","aria-pressed":n,onClick:()=>a(s),className:"w-8 h-8 grid place-items-center rounded-md text-white/85 transition "+(n?"bg-white !text-[#0f0f0f] shadow ring-1 ring-white/50":"hover:bg-white/10 active:bg-white/20"),title:s[0].toUpperCase()+s.slice(1),"aria-label":s,children:t.jsx(Z,{mode:s})},s)})})},ee=({tabs:e,value:a,onChange:o,className:r})=>t.jsx("div",{className:(r??"")+" flex gap-1 bg-neutral-100 dark:bg-neutral-900 p-1 rounded-lg border border-neutral-200 dark:border-neutral-800",children:e.map(s=>{const n=s.key===a;return t.jsx("button",{onClick:()=>o(s.key),className:"px-3 py-1.5 rounded-md text-sm transition "+(n?"bg-white dark:bg-neutral-800 shadow border border-neutral-200 dark:border-neutral-700":"hover:bg-white/60 dark:hover:bg-neutral-800/60"),"aria-selected":n,role:"tab",children:t.jsxs("span",{className:"flex items-center gap-2",children:[s.icon,t.jsx("span",{children:s.label})]})},s.key)})});/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=f("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=f("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=f("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=f("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=f("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=f("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=f("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ie=()=>{const[e,a]=u.useState(null),o=u.useRef(null);if(u.useEffect(()=>{M().then(a)},[]),!e)return null;const r=async()=>{const c=JSON.stringify(e,null,2),i=new Blob([c],{type:"application/json"}),m=URL.createObjectURL(i),g=document.createElement("a");g.href=m,g.download="media-controller-settings.json",g.click(),URL.revokeObjectURL(m)},s=async c=>{const i=await c.text(),m=JSON.parse(i);await p(m),a(m)},n=async()=>{await p(k),a(k)};return t.jsxs("div",{className:"mt-3 space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.rememberLastPerChannel,onChange:async c=>{const i={rememberLastPerChannel:c.target.checked};await p(i),a({...e,...i})}}),t.jsx("span",{children:"Remember last used speed per channel"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.visible||e.showOverlay,onChange:async c=>{const i={overlay:{...e.overlay,visible:c.target.checked},showOverlay:c.target.checked};await p(i),a({...e,...i})}}),t.jsx("span",{children:"Show in-player controller overlay"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.autoHide,onChange:async c=>{const i={overlay:{...e.overlay,autoHide:c.target.checked}};await p(i),a({...e,...i})}}),t.jsx("span",{children:"Auto-hide overlay until hovered"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(w,{onClick:r,children:[t.jsx(se,{className:"w-4 h-4"}),t.jsx("span",{children:"Export settings"})]}),t.jsx("input",{ref:o,type:"file",accept:"application/json",className:"hidden",onChange:c=>c.target.files&&s(c.target.files[0])}),t.jsxs(w,{onClick:()=>{var c;return(c=o.current)==null?void 0:c.click()},children:[t.jsx(W,{className:"w-4 h-4"}),t.jsx("span",{children:"Import settings"})]}),t.jsxs(w,{variant:"danger",className:"ml-auto",onClick:n,children:[t.jsx(ne,{className:"w-4 h-4"}),t.jsx("span",{children:"Reset to defaults"})]})]})]})};function oe({children:e,className:a=""}){return t.jsx("div",{className:`p-5 rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 shadow-sm ${a}`,children:e})}const de=e=>{const a=e.rates.length?Math.min(.1,...e.rates):.1,o=e.rates.length?Math.max(4,...e.rates):4;return t.jsxs("div",{className:"mt-3",children:[t.jsx(oe,{className:"hover:shadow-md",children:t.jsx(D,{min:a,max:o,value:e.sliderRate,onChange:async r=>{e.setSliderRate(r),await e.apply(r)},onClear:async()=>{e.setSliderRate(e.defaultRate),await e.apply(e.defaultRate)}})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(H,{presets:e.rates,onSelect:async r=>{e.setSliderRate(r),await e.apply(r)},onRemove:e.removeRate,currentRate:e.sliderRate}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx(O,{type:"number",uiSize:"md",step:"0.05",placeholder:"Custom speed (e.g. 1.25)",value:e.customRateInput,onChange:r=>e.setCustomRateInput(r.target.value),onKeyDown:r=>{r.key==="Enter"&&e.addCustomRate()},className:"flex-1 placeholder:text-neutral-400",inputMode:"decimal","aria-label":"Custom speed"}),t.jsxs(w,{onClick:e.addCustomRate,children:[t.jsx(z,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Add"})]}),t.jsxs(w,{onClick:e.addRate,children:[t.jsx(te,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"+0.25"})]})]})]}),t.jsx("div",{className:"flex items-center gap-2 mt-4",children:t.jsx("div",{className:"ml-auto",children:t.jsxs(w,{onClick:e.onSave,children:[t.jsx(V,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Save"})]})})})]})};function he(e){return Math.max(.1,e)}function ue(){const e=document.querySelector("video.html5-main-video");return e&&!Number.isNaN(e.playbackRate)?e:document.querySelector("video")}function I(e){return e.__reverseController??null}function A(e,a){e.__reverseController=a}function C(e){const a=I(e);a!=null&&a.rafId&&cancelAnimationFrame(a.rafId),A(e,null)}function me(e,a){C(e);const o={rafId:null,lastTimestampMs:null,speedAbs:a};A(e,o);try{e.pause()}catch{}const r=s=>{if(!document.contains(e)){C(e);return}const n=I(e);if(!n)return;const c=n.lastTimestampMs??s,i=Math.min(.25,Math.max(0,(s-c)/1e3));n.lastTimestampMs=s;const m=i*n.speedAbs,g=Math.max(0,e.currentTime-m);e.currentTime=g,n.rafId=requestAnimationFrame(r)};o.rafId=requestAnimationFrame(r)}function xe(e){const a=ue();if(!a)return!1;if(e<0){const r=Math.abs(e);return a.playbackRate=0,me(a,r),a.dispatchEvent(new Event("ratechange")),!0}C(a);const o=he(e);return a.playbackRate=o,a.dispatchEvent(new Event("ratechange")),!0}const h=globalThis.browser??chrome;async function ye(e){var a,o,r,s;try{if((a=h==null?void 0:h.tabs)!=null&&a.query){const[n]=await h.tabs.query({active:!0,currentWindow:!0});if(n!=null&&n.id)try{await h.tabs.sendMessage(n.id,{type:"SET_PLAYBACK_RATE",rate:e}),await h.action.setBadgeBackgroundColor({tabId:n.id,color:"#111827"}),(o=h.action)!=null&&o.setBadgeTextColor&&await h.action.setBadgeTextColor({tabId:n.id,color:"#FFFFFF"}),await h.action.setBadgeText({tabId:n.id,text:R(e)});return}catch{try{(r=h.scripting)!=null&&r.executeScript&&await h.scripting.executeScript({target:{tabId:n.id},func:c=>{const i=document.querySelector("video");i&&(i.playbackRate=c,i.dispatchEvent(new Event("ratechange")))},args:[e]}),await h.action.setBadgeBackgroundColor({tabId:n.id,color:"#111827"}),(s=h.action)!=null&&s.setBadgeTextColor&&await h.action.setBadgeTextColor({tabId:n.id,color:"#FFFFFF"}),await h.action.setBadgeText({tabId:n.id,text:R(e)});return}catch{}}}}catch{}xe(e)}function T(e){return Math.round(e*100)/100}const b=globalThis.browser??chrome,ge=()=>{const[e,a]=u.useState(k.customRates),[o,r]=u.useState(k.defaultPlaybackRate),[s,n]=u.useState(k.theme??"system"),[c,i]=u.useState(k.defaultPlaybackRate),[m,g]=u.useState(""),[v,E]=u.useState("general"),[N,B]=u.useState(null),S=u.useRef(null);u.useEffect(()=>{S.current=N},[N]),u.useEffect(()=>{(async()=>{const l=await M();a(l.customRates),r(l.defaultPlaybackRate),n(l.theme??"system"),i(l.defaultPlaybackRate||1);const[d]=await b.tabs.query({active:!0,currentWindow:!0});if(B((d==null?void 0:d.id)??null),d!=null&&d.id)try{await b.tabs.sendMessage(d.id,{type:"GET_PLAYBACK_RATE"})}catch{}})()},[]),u.useEffect(()=>{const l=document.documentElement,d=s==="dark"||s==="system"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;l.classList.toggle("dark",d)},[s]),u.useEffect(()=>{G((l,d)=>{var x;if(l.type==="CURRENT_PLAYBACK_RATE"){const y=((x=d.tab)==null?void 0:x.id)??null;y&&y===S.current&&(i(l.rate),r(l.rate),(async()=>{var j;try{await b.action.setBadgeBackgroundColor({tabId:y,color:"#111827"}),(j=b.action)!=null&&j.setBadgeTextColor&&await b.action.setBadgeTextColor({tabId:y,color:"#FFFFFF"}),await b.action.setBadgeText({tabId:y,text:R(l.rate)})}catch{}})())}})},[]);async function P(l){await Q({type:"PAUSE_AUTOMATION",ms:1e4}),await ye(l),p({defaultPlaybackRate:l})}async function F(){await p({customRates:e,defaultPlaybackRate:o,theme:s})}const L=()=>a(l=>Array.from(new Set([...l,T((l[l.length-1]??1)+.25)])).sort((d,x)=>d-x)),q=()=>{const l=Number(m);if(!Number.isFinite(l)||l<=0)return;const d=T(l);a(x=>Array.from(new Set([...x,d])).sort((y,j)=>y-j)),g("")},U=l=>{a(d=>d.filter(x=>x!==l).sort((x,y)=>x-y))},_=[{key:"general",label:"General",icon:t.jsx(le,{className:"w-4 h-4"})},{key:"profiles",label:"Profiles",icon:t.jsx(ae,{className:"w-4 h-4"})},{key:"automation",label:"Automation",icon:t.jsx(ce,{className:"w-4 h-4"})},{key:"settings",label:"Settings",icon:t.jsx(re,{className:"w-4 h-4"})}];return t.jsxs("div",{className:"min-w-[700px] p-0 font-sans text-neutral-900 dark:text-neutral-100 bg-white dark:bg-neutral-950",children:[t.jsxs("div",{className:"px-4 py-3 mb-0 bg-[#0f0f0f] text-white flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col leading-tight",children:[t.jsx("span",{className:"text-sm opacity-80",children:"Playback Controller"}),t.jsx("h3",{className:"m-0 text-lg font-semibold tracking-wide",children:"Media Controls"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("a",{href:"https://hamibash.com/faez",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 text-white text-sm border border-white/15 transition active:scale-[.98]",children:[t.jsx(J,{className:"w-4 h-4"}),t.jsx("span",{children:"Support"})]}),t.jsx($,{value:s,onChange:n})]})]}),t.jsxs("div",{className:"p-4 pt-3",children:[t.jsx(ee,{tabs:_,value:v,onChange:E}),v==="general"&&t.jsx(de,{rates:e,sliderRate:c,setSliderRate:i,defaultRate:o,apply:P,onSave:F,removeRate:U,customRateInput:m,setCustomRateInput:g,addCustomRate:q,addRate:L}),v==="profiles"&&t.jsx(K,{}),v==="automation"&&t.jsx(Y,{}),v==="settings"&&t.jsx(ie,{})]})]})},pe=X(document.getElementById("root"));pe.render(t.jsx(ge,{}));
