import{j as t,c as b,r as u,g as M,s as p,A as k,U as D,D as w,S as W,P as O,I as H,a as z,b as V,o as Y,H as G,d as J,e as K,f as Q,h as X}from"./chunks/PresetList-BZDvVy-t.js";import{f as R}from"./chunks/badge-CCCdnOXL.js";const Z=({mode:e})=>e==="light"?t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("path",{d:"M12 4V2M12 22v-2M4 12H2M22 12h-2M5.64 5.64 4.22 4.22M19.78 19.78l-1.42-1.42M18.36 5.64l1.42-1.42M4.22 19.78l1.42-1.42",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}),t.jsx("circle",{cx:"12",cy:"12",r:"4.5",stroke:"currentColor",strokeWidth:"1.5"})]}):e==="dark"?t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z",stroke:"currentColor",strokeWidth:"1.5",fill:"currentColor"})}):t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("rect",{x:"3",y:"5",width:"18",height:"14",rx:"2",stroke:"currentColor",strokeWidth:"1.5"}),t.jsx("path",{d:"M3 15h18",stroke:"currentColor",strokeWidth:"1.5"})]}),$=({value:e,onChange:a,className:c})=>{const n=["system","light","dark"];return t.jsx("div",{className:(c??"")+" flex items-center gap-1 rounded-lg border border-white/20 bg-white/10 p-0.5",role:"group","aria-label":"Theme",children:n.map(s=>{const r=e===s;return t.jsx("button",{type:"button","aria-pressed":r,onClick:()=>a(s),className:"w-8 h-8 grid place-items-center rounded-md text-white/85 transition "+(r?"bg-white !text-[#0f0f0f] shadow ring-1 ring-white/50":"hover:bg-white/10 active:bg-white/20"),title:s[0].toUpperCase()+s.slice(1),"aria-label":s,children:t.jsx(Z,{mode:s})},s)})})},ee=({tabs:e,value:a,onChange:c,className:n})=>t.jsx("div",{className:(n??"")+" flex gap-1 bg-neutral-100 dark:bg-neutral-900 p-1 rounded-lg border border-neutral-200 dark:border-neutral-800",children:e.map(s=>{const r=s.key===a;return t.jsx("button",{onClick:()=>c(s.key),className:"px-3 py-1.5 rounded-md text-sm transition "+(r?"bg-white dark:bg-neutral-800 shadow border border-neutral-200 dark:border-neutral-700":"hover:bg-white/60 dark:hover:bg-neutral-800/60"),"aria-selected":r,role:"tab",children:t.jsxs("span",{className:"flex items-center gap-2",children:[s.icon,t.jsx("span",{children:s.label})]})},s.key)})});/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=b("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=b("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=b("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=b("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=b("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=b("SlidersVertical",[["line",{x1:"4",x2:"4",y1:"21",y2:"14",key:"1p332r"}],["line",{x1:"4",x2:"4",y1:"10",y2:"3",key:"gb41h5"}],["line",{x1:"12",x2:"12",y1:"21",y2:"12",key:"hf2csr"}],["line",{x1:"12",x2:"12",y1:"8",y2:"3",key:"1kfi7u"}],["line",{x1:"20",x2:"20",y1:"21",y2:"16",key:"1lhrwl"}],["line",{x1:"20",x2:"20",y1:"12",y2:"3",key:"16vvfq"}],["line",{x1:"2",x2:"6",y1:"14",y2:"14",key:"1uebub"}],["line",{x1:"10",x2:"14",y1:"8",y2:"8",key:"1yglbp"}],["line",{x1:"18",x2:"22",y1:"16",y2:"16",key:"1jxqpz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=b("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ie=()=>{const[e,a]=u.useState(null),c=u.useRef(null);if(u.useEffect(()=>{M().then(a)},[]),!e)return null;const n=async()=>{const i=JSON.stringify(e,null,2),o=new Blob([i],{type:"application/json"}),m=URL.createObjectURL(o),g=document.createElement("a");g.href=m,g.download="media-controller-settings.json",g.click(),URL.revokeObjectURL(m)},s=async i=>{const o=await i.text(),m=JSON.parse(o);await p(m),a(m)},r=async()=>{await p(w),a(w)};return t.jsxs("div",{className:"mt-3 space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.rememberLastPerChannel,onChange:async i=>{const o={rememberLastPerChannel:i.target.checked};await p(o),a({...e,...o})}}),t.jsx("span",{children:"Remember last used speed per channel"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.visible||e.showOverlay,onChange:async i=>{const o={overlay:{...e.overlay,visible:i.target.checked},showOverlay:i.target.checked};await p(o),a({...e,...o})}}),t.jsx("span",{children:"Show in-player controller overlay"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:e.overlay.autoHide,onChange:async i=>{const o={overlay:{...e.overlay,autoHide:i.target.checked}};await p(o),a({...e,...o})}}),t.jsx("span",{children:"Auto-hide overlay until hovered"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(k,{onClick:n,children:[t.jsx(se,{className:"w-4 h-4"}),t.jsx("span",{children:"Export settings"})]}),t.jsx("input",{ref:c,type:"file",accept:"application/json",className:"hidden",onChange:i=>i.target.files&&s(i.target.files[0])}),t.jsxs(k,{onClick:()=>{var i;return(i=c.current)==null?void 0:i.click()},children:[t.jsx(D,{className:"w-4 h-4"}),t.jsx("span",{children:"Import settings"})]}),t.jsxs(k,{variant:"danger",className:"ml-auto",onClick:r,children:[t.jsx(ne,{className:"w-4 h-4"}),t.jsx("span",{children:"Reset to defaults"})]})]})]})};function oe({children:e,className:a=""}){return t.jsx("div",{className:`p-5 rounded-xl border border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-900 shadow-sm ${a}`,children:e})}const de=e=>{const a=e.rates.length?Math.min(.1,...e.rates):.1,c=e.rates.length?Math.max(4,...e.rates):4;return t.jsxs("div",{className:"mt-3",children:[t.jsx(oe,{className:"hover:shadow-md",children:t.jsx(W,{min:a,max:c,value:e.sliderRate,onChange:async n=>{e.setSliderRate(n),await e.apply(n)},onClear:async()=>{e.setSliderRate(e.defaultRate),await e.apply(e.defaultRate)}})}),t.jsxs("div",{className:"mt-4",children:[t.jsx(O,{presets:e.rates,onSelect:async n=>{e.setSliderRate(n),await e.apply(n)},onRemove:e.removeRate,currentRate:e.sliderRate}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx(H,{type:"number",uiSize:"md",step:"0.05",placeholder:"Custom speed (e.g. 1.25)",value:e.customRateInput,onChange:n=>e.setCustomRateInput(n.target.value),onKeyDown:n=>{n.key==="Enter"&&e.addCustomRate()},className:"flex-1 placeholder:text-neutral-400",inputMode:"decimal","aria-label":"Custom speed"}),t.jsxs(k,{onClick:e.addCustomRate,children:[t.jsx(z,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Add"})]}),t.jsxs(k,{onClick:e.addRate,children:[t.jsx(te,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"+0.25"})]})]})]}),t.jsx("div",{className:"flex items-center gap-2 mt-4",children:t.jsx("div",{className:"ml-auto",children:t.jsxs(k,{onClick:e.onSave,children:[t.jsx(V,{className:"w-4 h-4"}),t.jsx("span",{className:"ml-1",children:"Save"})]})})})]})},he=[.25,.5,.75,1,1.25,1.5,1.75,2];function ue(e){const a=he,c=Math.min(a[a.length-1],Math.max(a[0],e));return a.reduce((n,s)=>Math.abs(s-c)<Math.abs(n-c)?s:n,a[0])}function me(){const e=document.querySelector("video.html5-main-video");return e&&!Number.isNaN(e.playbackRate)?e:document.querySelector("video")}function A(e){return e.__reverseController??null}function E(e,a){e.__reverseController=a}function C(e){const a=A(e);a!=null&&a.rafId&&cancelAnimationFrame(a.rafId),E(e,null)}function xe(e,a){C(e);const c={rafId:null,lastTimestampMs:null,speedAbs:a};E(e,c);try{e.pause()}catch{}const n=s=>{if(!document.contains(e)){C(e);return}const r=A(e);if(!r)return;const i=r.lastTimestampMs??s,o=Math.min(.25,Math.max(0,(s-i)/1e3));r.lastTimestampMs=s;const m=o*r.speedAbs,g=Math.max(0,e.currentTime-m);e.currentTime=g,r.rafId=requestAnimationFrame(n)};c.rafId=requestAnimationFrame(n)}function ye(e){const a=me();if(!a)return!1;if(e<0){const n=Math.abs(e);return a.playbackRate=0,xe(a,n),a.dispatchEvent(new Event("ratechange")),!0}C(a);const c=ue(e);return a.playbackRate=c,a.dispatchEvent(new Event("ratechange")),!0}const h=globalThis.browser??chrome;async function ge(e){var a,c,n,s;try{if((a=h==null?void 0:h.tabs)!=null&&a.query){const[r]=await h.tabs.query({active:!0,currentWindow:!0});if(r!=null&&r.id)try{await h.tabs.sendMessage(r.id,{type:"SET_PLAYBACK_RATE",rate:e}),await h.action.setBadgeBackgroundColor({tabId:r.id,color:"#111827"}),(c=h.action)!=null&&c.setBadgeTextColor&&await h.action.setBadgeTextColor({tabId:r.id,color:"#FFFFFF"}),await h.action.setBadgeText({tabId:r.id,text:R(e)});return}catch{try{(n=h.scripting)!=null&&n.executeScript&&await h.scripting.executeScript({target:{tabId:r.id},func:i=>{const o=document.querySelector("video");o&&(o.playbackRate=i,o.dispatchEvent(new Event("ratechange")))},args:[e]}),await h.action.setBadgeBackgroundColor({tabId:r.id,color:"#111827"}),(s=h.action)!=null&&s.setBadgeTextColor&&await h.action.setBadgeTextColor({tabId:r.id,color:"#FFFFFF"}),await h.action.setBadgeText({tabId:r.id,text:R(e)});return}catch{}}}}catch{}ye(e)}function T(e){return Math.round(e*100)/100}const f=globalThis.browser??chrome,pe=()=>{const[e,a]=u.useState(w.customRates),[c,n]=u.useState(w.defaultPlaybackRate),[s,r]=u.useState(w.theme??"system"),[i,o]=u.useState(w.defaultPlaybackRate),[m,g]=u.useState(""),[v,I]=u.useState("general"),[N,P]=u.useState(null),S=u.useRef(null);u.useEffect(()=>{S.current=N},[N]),u.useEffect(()=>{(async()=>{const l=await M();a(l.customRates),n(l.defaultPlaybackRate),r(l.theme??"system"),o(l.defaultPlaybackRate||1);const[d]=await f.tabs.query({active:!0,currentWindow:!0});if(P((d==null?void 0:d.id)??null),d!=null&&d.id)try{await f.tabs.sendMessage(d.id,{type:"GET_PLAYBACK_RATE"})}catch{}})()},[]),u.useEffect(()=>{const l=document.documentElement,d=s==="dark"||s==="system"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;l.classList.toggle("dark",d)},[s]),u.useEffect(()=>{Y((l,d)=>{var x;if(l.type==="CURRENT_PLAYBACK_RATE"){const y=((x=d.tab)==null?void 0:x.id)??null;y&&y===S.current&&(o(l.rate),n(l.rate),(async()=>{var j;try{await f.action.setBadgeBackgroundColor({tabId:y,color:"#111827"}),(j=f.action)!=null&&j.setBadgeTextColor&&await f.action.setBadgeTextColor({tabId:y,color:"#FFFFFF"}),await f.action.setBadgeText({tabId:y,text:R(l.rate)})}catch{}})())}})},[]);async function B(l){await Q({type:"PAUSE_AUTOMATION",ms:1e4}),await ge(l),p({defaultPlaybackRate:l})}async function F(){await p({customRates:e,defaultPlaybackRate:c,theme:s})}const L=()=>a(l=>Array.from(new Set([...l,T((l[l.length-1]??1)+.25)])).sort((d,x)=>d-x)),q=()=>{const l=Number(m);if(!Number.isFinite(l)||l<=0)return;const d=T(l);a(x=>Array.from(new Set([...x,d])).sort((y,j)=>y-j)),g("")},_=l=>{a(d=>d.filter(x=>x!==l).sort((x,y)=>x-y))},U=[{key:"general",label:"General",icon:t.jsx(le,{className:"w-4 h-4"})},{key:"profiles",label:"Profiles",icon:t.jsx(ae,{className:"w-4 h-4"})},{key:"automation",label:"Automation",icon:t.jsx(ce,{className:"w-4 h-4"})},{key:"settings",label:"Settings",icon:t.jsx(re,{className:"w-4 h-4"})}];return t.jsxs("div",{className:"min-w-[700px] p-0 font-sans text-neutral-900 dark:text-neutral-100 bg-white dark:bg-neutral-950",children:[t.jsxs("div",{className:"px-4 py-3 mb-0 bg-[#0f0f0f] text-white flex items-center justify-between",children:[t.jsxs("div",{className:"flex flex-col leading-tight",children:[t.jsx("span",{className:"text-sm opacity-80",children:"Playback Controller"}),t.jsx("h3",{className:"m-0 text-lg font-semibold tracking-wide",children:"Media Controls"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("a",{href:"https://hamibash.com/faez",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-md bg-white/10 hover:bg-white/20 text-white text-sm border border-white/15 transition active:scale-[.98]",children:[t.jsx(G,{className:"w-4 h-4"}),t.jsx("span",{children:"Support"})]}),t.jsx($,{value:s,onChange:r})]})]}),t.jsxs("div",{className:"p-4 pt-3",children:[t.jsx(ee,{tabs:U,value:v,onChange:I}),v==="general"&&t.jsx(de,{rates:e,sliderRate:i,setSliderRate:o,defaultRate:c,apply:B,onSave:F,removeRate:_,customRateInput:m,setCustomRateInput:g,addCustomRate:q,addRate:L}),v==="profiles"&&t.jsx(J,{}),v==="automation"&&t.jsx(K,{}),v==="settings"&&t.jsx(ie,{})]})]})},be=X(document.getElementById("root"));be.render(t.jsx(pe,{}));
